{"ast":null,"code":"import _asyncToGenerator from \"C:/SpringBOot/ecommerce-project/03-frontend/angular-ecommerce/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\n/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * \n * See the License for the specific language governing permissions and limitations under the License.\n */\n\nimport { isBrowser } from '../features.js';\nconst getNow = () => Math.floor(Date.now() / 1000);\nclass RenewOnTabActivationService {\n  constructor(tokenManager, options = {}) {\n    this.started = false;\n    this.lastHidden = -1;\n    this.tokenManager = tokenManager;\n    this.options = options;\n    this.onPageVisbilityChange = this._onPageVisbilityChange.bind(this);\n  }\n  _onPageVisbilityChange() {\n    if (document.hidden) {\n      this.lastHidden = getNow();\n    } else if (this.lastHidden > 0 && getNow() - this.lastHidden >= this.options.tabInactivityDuration) {\n      const {\n        accessToken,\n        idToken\n      } = this.tokenManager.getTokensSync();\n      if (!!accessToken && this.tokenManager.hasExpired(accessToken)) {\n        const key = this.tokenManager.getStorageKeyByType('accessToken');\n        this.tokenManager.renew(key).catch(() => {});\n      } else if (!!idToken && this.tokenManager.hasExpired(idToken)) {\n        const key = this.tokenManager.getStorageKeyByType('idToken');\n        this.tokenManager.renew(key).catch(() => {});\n      }\n    }\n  }\n  start() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      if (_this.canStart() && !!document) {\n        document.addEventListener('visibilitychange', _this.onPageVisbilityChange);\n        _this.started = true;\n      }\n    })();\n  }\n  stop() {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      if (document) {\n        document.removeEventListener('visibilitychange', _this2.onPageVisbilityChange);\n        _this2.started = false;\n      }\n    })();\n  }\n  canStart() {\n    return isBrowser() && !!this.options.autoRenew && !!this.options.renewOnTabActivation && !this.started;\n  }\n  requiresLeadership() {\n    return false;\n  }\n  isStarted() {\n    return this.started;\n  }\n}\nexport { RenewOnTabActivationService };","map":{"version":3,"names":["isBrowser","getNow","Math","floor","Date","now","RenewOnTabActivationService","constructor","tokenManager","options","started","lastHidden","onPageVisbilityChange","_onPageVisbilityChange","bind","document","hidden","tabInactivityDuration","accessToken","idToken","getTokensSync","hasExpired","key","getStorageKeyByType","renew","catch","start","_this","_asyncToGenerator","canStart","addEventListener","stop","_this2","removeEventListener","autoRenew","renewOnTabActivation","requiresLeadership","isStarted"],"sources":["C:/SpringBOot/ecommerce-project/03-frontend/angular-ecommerce/node_modules/@okta/okta-auth-js/esm/browser/services/RenewOnTabActivationService.js"],"sourcesContent":["/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * \n * See the License for the specific language governing permissions and limitations under the License.\n */\n\nimport { isBrowser } from '../features.js';\n\nconst getNow = () => Math.floor(Date.now() / 1000);\nclass RenewOnTabActivationService {\n    constructor(tokenManager, options = {}) {\n        this.started = false;\n        this.lastHidden = -1;\n        this.tokenManager = tokenManager;\n        this.options = options;\n        this.onPageVisbilityChange = this._onPageVisbilityChange.bind(this);\n    }\n    _onPageVisbilityChange() {\n        if (document.hidden) {\n            this.lastHidden = getNow();\n        }\n        else if (this.lastHidden > 0 && (getNow() - this.lastHidden >= this.options.tabInactivityDuration)) {\n            const { accessToken, idToken } = this.tokenManager.getTokensSync();\n            if (!!accessToken && this.tokenManager.hasExpired(accessToken)) {\n                const key = this.tokenManager.getStorageKeyByType('accessToken');\n                this.tokenManager.renew(key).catch(() => { });\n            }\n            else if (!!idToken && this.tokenManager.hasExpired(idToken)) {\n                const key = this.tokenManager.getStorageKeyByType('idToken');\n                this.tokenManager.renew(key).catch(() => { });\n            }\n        }\n    }\n    async start() {\n        if (this.canStart() && !!document) {\n            document.addEventListener('visibilitychange', this.onPageVisbilityChange);\n            this.started = true;\n        }\n    }\n    async stop() {\n        if (document) {\n            document.removeEventListener('visibilitychange', this.onPageVisbilityChange);\n            this.started = false;\n        }\n    }\n    canStart() {\n        return isBrowser() &&\n            !!this.options.autoRenew &&\n            !!this.options.renewOnTabActivation &&\n            !this.started;\n    }\n    requiresLeadership() {\n        return false;\n    }\n    isStarted() {\n        return this.started;\n    }\n}\n\nexport { RenewOnTabActivationService };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}