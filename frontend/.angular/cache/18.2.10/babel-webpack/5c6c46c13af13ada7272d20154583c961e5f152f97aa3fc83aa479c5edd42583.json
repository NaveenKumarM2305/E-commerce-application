{"ast":null,"code":"import { loc, createCallout } from '../../../../../packages/@okta/courage-dist/esm/src/CourageForSigninWidget.js';\nimport '../../../../../packages/@okta/courage-dist/esm/src/courage/framework/Model.js';\nimport '../../../../../packages/@okta/courage-dist/esm/src/courage/vendor/lib/backbone.js';\nimport '../../../../../packages/@okta/courage-dist/esm/src/courage/util/jquery-wrapper.js';\nimport '../../../../../packages/@okta/courage-dist/esm/src/courage/util/underscore-wrapper.js';\nimport '../../../../../packages/@okta/courage-dist/esm/lib/handlebars/dist/cjs/handlebars.runtime.js';\nimport '../../../../../packages/@okta/courage-dist/esm/src/courage/models/Model.js';\nimport '../../../../../packages/@okta/courage-dist/esm/src/courage/models/BaseModel.js';\nimport '../../../../../packages/@okta/courage-dist/esm/src/courage/framework/View.js';\nimport '../../../../../packages/@okta/courage-dist/esm/src/courage/views/Backbone.ListView.js';\nimport '../../internals/BaseHeader.js';\nimport BaseFooter from '../../internals/BaseFooter.js';\nimport '../../internals/BaseForm.js';\nimport '../../internals/BaseFormWithPolling.js';\nimport Body$1 from '../../internals/BaseOktaVerifyChallengeView.js';\nimport BaseView from '../../internals/BaseView.js';\nimport '../../components/AuthenticatorEnrollOptions.js';\nimport '../../components/AuthenticatorVerifyOptions.js';\nimport '../../../../../packages/@okta/courage-dist/esm/lib/underscore/underscore-min.js';\nimport 'cross-fetch';\nimport '../../../../util/BrowserFeatures.js';\nimport '../../../../util/FactorUtil.js';\nimport Enums from '../../../../util/Enums.js';\nimport '../../../../v1/views/admin-consent/ScopeList.js';\nimport '../../../../v1/views/consent/ScopeList.js';\nimport '../captcha/CaptchaView.js';\nimport { CANCEL_POLLING_ACTION, IDENTIFIER_FLOW, AUTHENTICATION_CANCEL_REASONS } from '../../utils/Constants.js';\nimport Link from '../../components/Link.js';\nimport { doChallenge, cancelPollingWithParams } from '../../utils/ChallengeViewUtil.js';\nimport OktaVerifyAuthenticatorHeader from '../../components/OktaVerifyAuthenticatorHeader.js';\nimport { getSignOutLink } from '../../utils/LinksUtil.js';\nimport CustomAccessDeniedErrorMessage from '../shared/CustomAccessDeniedErrorMessage.js';\nconst CUSTOM_ACCESS_DENIED_KEY = 'security.access_denied_custom_message';\nconst Body = Body$1.extend({\n  pollingCancelAction: CANCEL_POLLING_ACTION,\n  getDeviceChallengePayload: function () {\n    return this.options.currentViewState.relatesTo.value;\n  },\n  doChallenge: function () {\n    doChallenge(this, IDENTIFIER_FLOW);\n  },\n  onPollingFail: function () {\n    Body$1.prototype.onPollingFail.apply(this, arguments);\n    // When SIW receives form error, polling is already stopped\n    // SIW needs to update footer link from /poll/cancel to /idp/idx/cancel\n    const data = {\n      label: loc('loopback.polling.cancel.link.with.form.error', 'login')\n    };\n    this.options.appState.trigger('updateFooterLink', data);\n  },\n  showCustomFormErrorCallout: function (error, messages) {\n    const responseJSON = error.responseJSON;\n    let options = {\n      type: 'error',\n      className: 'okta-verify-uv-callout-content',\n      subtitle: responseJSON.errorSummary\n    };\n    const containsSignedNonceError = responseJSON.errorSummaryKeys && responseJSON.errorSummaryKeys.some(key => key.includes('auth.factor.signedNonce.error'));\n    if (containsSignedNonceError) {\n      options.title = loc('user.fail.verifyIdentity', 'login');\n    }\n    const containsCustomAccessDeniedError = responseJSON.errorSummaryKeys && responseJSON.errorSummaryKeys.some(key => key.includes('security.access_denied_custom_message'));\n    if (containsCustomAccessDeniedError) {\n      const message = messages === null || messages === void 0 ? void 0 : messages.find(message => message.i18n.key === CUSTOM_ACCESS_DENIED_KEY);\n      if (!message) {\n        return false;\n      }\n      options = {\n        type: 'error',\n        content: new CustomAccessDeniedErrorMessage({\n          message: responseJSON.errorSummary,\n          links: message.links\n        })\n      };\n    }\n    this.showMessages(createCallout(options));\n    return true;\n  }\n});\nconst Footer = BaseFooter.extend({\n  initialize: function () {\n    this.listenTo(this.options.appState, 'updateFooterLink', this.handleUpdateFooterLink);\n    if (this.isFallbackApproach() && !this.isFallbackDelayed()) {\n      BaseFooter.prototype.initialize.apply(this, arguments);\n    } else {\n      this.backLink = this.add(Link, {\n        options: {\n          name: 'cancel-authenticator-challenge',\n          label: loc('loopback.polling.cancel.link', 'login'),\n          clickHandler: () => {\n            cancelPollingWithParams(this.options.appState, CANCEL_POLLING_ACTION, AUTHENTICATION_CANCEL_REASONS.USER_CANCELED, null);\n          }\n        }\n      }).last();\n    }\n  },\n  handleUpdateFooterLink: function (data) {\n    // only update link for loopback\n    if (!this.isFallbackApproach() || this.isFallbackDelayed()) {\n      this.backLink && this.backLink.remove();\n      this.backLink = this.add(Link, {\n        options: getSignOutLink(this.options.settings, data)[0]\n      }).last();\n    }\n  },\n  isFallbackApproach: function () {\n    return [Enums.CUSTOM_URI_CHALLENGE, Enums.UNIVERSAL_LINK_CHALLENGE, Enums.APP_LINK_CHALLENGE].includes(this.options.currentViewState.relatesTo.value.challengeMethod);\n  },\n  isFallbackDelayed: function () {\n    // only delay showing the reopen Okta Verify button for the app link approach for now\n    // until we have more data shows other approaches have the slow cold start problem of the Okta Verify app as well\n    return this.options.currentViewState.relatesTo.value.challengeMethod === Enums.APP_LINK_CHALLENGE;\n  }\n});\nvar DeviceChallengePollView = BaseView.extend({\n  Header: OktaVerifyAuthenticatorHeader,\n  Body: Body,\n  Footer: Footer\n});\nexport { DeviceChallengePollView as default };","map":{"version":3,"names":["loc","createCallout","BaseFooter","Body$1","BaseView","Enums","CANCEL_POLLING_ACTION","IDENTIFIER_FLOW","AUTHENTICATION_CANCEL_REASONS","Link","doChallenge","cancelPollingWithParams","OktaVerifyAuthenticatorHeader","getSignOutLink","CustomAccessDeniedErrorMessage","CUSTOM_ACCESS_DENIED_KEY","Body","extend","pollingCancelAction","getDeviceChallengePayload","options","currentViewState","relatesTo","value","onPollingFail","prototype","apply","arguments","data","label","appState","trigger","showCustomFormErrorCallout","error","messages","responseJSON","type","className","subtitle","errorSummary","containsSignedNonceError","errorSummaryKeys","some","key","includes","title","containsCustomAccessDeniedError","message","find","i18n","content","links","showMessages","Footer","initialize","listenTo","handleUpdateFooterLink","isFallbackApproach","isFallbackDelayed","backLink","add","name","clickHandler","USER_CANCELED","last","remove","settings","CUSTOM_URI_CHALLENGE","UNIVERSAL_LINK_CHALLENGE","APP_LINK_CHALLENGE","challengeMethod","DeviceChallengePollView","Header","default"],"sources":["C:/SpringBOot/ecommerce-project/03-frontend/angular-ecommerce/node_modules/@okta/okta-signin-widget/dist/esm/src/v2/view-builder/views/device/DeviceChallengePollView.js"],"sourcesContent":["import { loc, createCallout } from '../../../../../packages/@okta/courage-dist/esm/src/CourageForSigninWidget.js';\nimport '../../../../../packages/@okta/courage-dist/esm/src/courage/framework/Model.js';\nimport '../../../../../packages/@okta/courage-dist/esm/src/courage/vendor/lib/backbone.js';\nimport '../../../../../packages/@okta/courage-dist/esm/src/courage/util/jquery-wrapper.js';\nimport '../../../../../packages/@okta/courage-dist/esm/src/courage/util/underscore-wrapper.js';\nimport '../../../../../packages/@okta/courage-dist/esm/lib/handlebars/dist/cjs/handlebars.runtime.js';\nimport '../../../../../packages/@okta/courage-dist/esm/src/courage/models/Model.js';\nimport '../../../../../packages/@okta/courage-dist/esm/src/courage/models/BaseModel.js';\nimport '../../../../../packages/@okta/courage-dist/esm/src/courage/framework/View.js';\nimport '../../../../../packages/@okta/courage-dist/esm/src/courage/views/Backbone.ListView.js';\nimport '../../internals/BaseHeader.js';\nimport BaseFooter from '../../internals/BaseFooter.js';\nimport '../../internals/BaseForm.js';\nimport '../../internals/BaseFormWithPolling.js';\nimport Body$1 from '../../internals/BaseOktaVerifyChallengeView.js';\nimport BaseView from '../../internals/BaseView.js';\nimport '../../components/AuthenticatorEnrollOptions.js';\nimport '../../components/AuthenticatorVerifyOptions.js';\nimport '../../../../../packages/@okta/courage-dist/esm/lib/underscore/underscore-min.js';\nimport 'cross-fetch';\nimport '../../../../util/BrowserFeatures.js';\nimport '../../../../util/FactorUtil.js';\nimport Enums from '../../../../util/Enums.js';\nimport '../../../../v1/views/admin-consent/ScopeList.js';\nimport '../../../../v1/views/consent/ScopeList.js';\nimport '../captcha/CaptchaView.js';\nimport { CANCEL_POLLING_ACTION, IDENTIFIER_FLOW, AUTHENTICATION_CANCEL_REASONS } from '../../utils/Constants.js';\nimport Link from '../../components/Link.js';\nimport { doChallenge, cancelPollingWithParams } from '../../utils/ChallengeViewUtil.js';\nimport OktaVerifyAuthenticatorHeader from '../../components/OktaVerifyAuthenticatorHeader.js';\nimport { getSignOutLink } from '../../utils/LinksUtil.js';\nimport CustomAccessDeniedErrorMessage from '../shared/CustomAccessDeniedErrorMessage.js';\n\nconst CUSTOM_ACCESS_DENIED_KEY = 'security.access_denied_custom_message';\nconst Body = Body$1.extend({\n  pollingCancelAction: CANCEL_POLLING_ACTION,\n  getDeviceChallengePayload: function () {\n    return this.options.currentViewState.relatesTo.value;\n  },\n  doChallenge: function () {\n    doChallenge(this, IDENTIFIER_FLOW);\n  },\n  onPollingFail: function () {\n    Body$1.prototype.onPollingFail.apply(this, arguments);\n    // When SIW receives form error, polling is already stopped\n    // SIW needs to update footer link from /poll/cancel to /idp/idx/cancel\n    const data = {\n      label: loc('loopback.polling.cancel.link.with.form.error', 'login')\n    };\n    this.options.appState.trigger('updateFooterLink', data);\n  },\n  showCustomFormErrorCallout: function (error, messages) {\n    const responseJSON = error.responseJSON;\n    let options = {\n      type: 'error',\n      className: 'okta-verify-uv-callout-content',\n      subtitle: responseJSON.errorSummary\n    };\n    const containsSignedNonceError = responseJSON.errorSummaryKeys && responseJSON.errorSummaryKeys.some(key => key.includes('auth.factor.signedNonce.error'));\n    if (containsSignedNonceError) {\n      options.title = loc('user.fail.verifyIdentity', 'login');\n    }\n    const containsCustomAccessDeniedError = responseJSON.errorSummaryKeys && responseJSON.errorSummaryKeys.some(key => key.includes('security.access_denied_custom_message'));\n    if (containsCustomAccessDeniedError) {\n      const message = messages === null || messages === void 0 ? void 0 : messages.find(message => message.i18n.key === CUSTOM_ACCESS_DENIED_KEY);\n      if (!message) {\n        return false;\n      }\n      options = {\n        type: 'error',\n        content: new CustomAccessDeniedErrorMessage({\n          message: responseJSON.errorSummary,\n          links: message.links\n        })\n      };\n    }\n    this.showMessages(createCallout(options));\n    return true;\n  }\n});\nconst Footer = BaseFooter.extend({\n  initialize: function () {\n    this.listenTo(this.options.appState, 'updateFooterLink', this.handleUpdateFooterLink);\n    if (this.isFallbackApproach() && !this.isFallbackDelayed()) {\n      BaseFooter.prototype.initialize.apply(this, arguments);\n    } else {\n      this.backLink = this.add(Link, {\n        options: {\n          name: 'cancel-authenticator-challenge',\n          label: loc('loopback.polling.cancel.link', 'login'),\n          clickHandler: () => {\n            cancelPollingWithParams(this.options.appState, CANCEL_POLLING_ACTION, AUTHENTICATION_CANCEL_REASONS.USER_CANCELED, null);\n          }\n        }\n      }).last();\n    }\n  },\n  handleUpdateFooterLink: function (data) {\n    // only update link for loopback\n    if (!this.isFallbackApproach() || this.isFallbackDelayed()) {\n      this.backLink && this.backLink.remove();\n      this.backLink = this.add(Link, {\n        options: getSignOutLink(this.options.settings, data)[0]\n      }).last();\n    }\n  },\n  isFallbackApproach: function () {\n    return [Enums.CUSTOM_URI_CHALLENGE, Enums.UNIVERSAL_LINK_CHALLENGE, Enums.APP_LINK_CHALLENGE].includes(this.options.currentViewState.relatesTo.value.challengeMethod);\n  },\n  isFallbackDelayed: function () {\n    // only delay showing the reopen Okta Verify button for the app link approach for now\n    // until we have more data shows other approaches have the slow cold start problem of the Okta Verify app as well\n    return this.options.currentViewState.relatesTo.value.challengeMethod === Enums.APP_LINK_CHALLENGE;\n  }\n});\nvar DeviceChallengePollView = BaseView.extend({\n  Header: OktaVerifyAuthenticatorHeader,\n  Body: Body,\n  Footer: Footer\n});\n\nexport { DeviceChallengePollView as default };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}